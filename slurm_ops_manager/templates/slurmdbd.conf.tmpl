# slurm.conf file generated by Juju.
DbdHost={{ active_slurmdbd_hostname }}
DbdAddr={{ active_slurmdbd_ingress_address }}

{% if backup_slurmdbd_hostname %}
{% if backup_slurmdbd_hostname != "" %}
DbdBackupHost={{ backup_slurmdbd_hostname }}
{% endif %}
{% endif %}

DbdPort={{ active_slurmdbd_port }}

AuthType=auth/munge
AuthInfo=socket={{ munge_socket }}
AuthAltTypes=auth/jwt
AuthAltParameters="jwt_key={{ jwt_rsa_key_file }}"

SlurmUser={{ slurm_user }}

PluginDir={{ slurm_plugin_dir }}

PidFile={{ slurmdbd_pid_file }}

LogFile={{ slurmdbd_log_file }}

StorageType=accounting_storage/mysql
{% if db_hostname -%}
StorageHost={{ db_hostname }}
StoragePort={{ db_port }}
{% endif -%}
StoragePass={{ db_password }}
StorageUser={{ db_username }}
StorageLoc={{ db_name }}

DebugLevel={{ slurmdbd_debug }} 

ArchiveEvents="yes"
ArchiveJobs="yes"
ArchiveResvs="yes"
ArchiveSteps="no"
ArchiveSuspend="no"
ArchiveTXN="no"
ArchiveUsage="no"

#ArchiveScript=/usr/sbin/slurm.dbd.archive

PurgeEventAfter="1month"
PurgeJobAfter="12month"
PurgeResvAfter="1month"
PurgeStepAfter="1month"
PurgeSuspendAfter="1month"
PurgeTXNAfter="12month"
PurgeUsageAfter="24month"
